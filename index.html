<!DOCTYPE html>
<html>
	<head>
		<title>Cribbage</title>
		<link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Volkhov' type='text/css' />
		<link rel="stylesheet" href="cribbage.css" />
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<!-- <script src="https://cdn.tailwindcss.com"></script> -->
		<script type='text/javascript' src='jquery-1.10.2.min.js'></script>
		<script type='text/javascript' src='underscore.js'></script>
		<!-- <script type='text/javascript' src='js/bootstrap.min.js'></script> -->
		<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/mithril/2.2.8/mithril.js" integrity="sha512-lUbh0FQKh58/xz0dTeHIVscVjf+ojZmvHqTWFnNxYo/xlUGmVgWFgjmrf735QshYsJYwswdOlHtjrxsuypHTQw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script> -->
	</head>
	<body>
		<div id="wrap">
			<div class="navbar navbar-default navbar-fixed-top">
				<div class="container">
					<div class="navbar-header">
						<a class="navbar-brand" href="#">Cribbage</a>
					</div>
				</div>
			</div>
			<div class="container">
				<div id="cribbage"></div>
			</div>
		</div>
		<div class="navbar navbar-fixed-bottom">
			<div class="container">
				<p class="text-muted credit">Cribbage by Adam Bucholz</p>
			</div>
		</div>
 	<script type="module">
		import { autorun } from "https://cdnjs.cloudflare.com/ajax/libs/mobx/6.13.5/mobx.esm.development.js"
		import {Controller} from "./controller.js";
		import {STATE} from "./utils.js";
		const controller = new Controller();
		const game = controller.game;

		// our click handlers need access to controller
		window.controller = controller;

		autorun(() => {
			const {duration} = game;
			const hasGameStarted = game.state !== STATE.waiting;
			let ui;

			if (hasGameStarted) {
				ui = controller.view.renders()["game_template"]({ game });
				ui += controller.view.renders()["crib_template"]({ game });
			} else {
				ui = controller.view.renders()["new_player_template"]({duration});
			}
			$('#cribbage').empty().append(ui);
			controller.view.renders()["draw_board"]({ game });
		})
 	</script>
	</body>
</html>
